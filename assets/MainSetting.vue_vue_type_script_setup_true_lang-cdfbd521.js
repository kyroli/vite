import{d as h,u as U,o as b,a as y,f as o,b as g,e as l,cm as v,cn as _,co as O,cp as T,cq as $,t as C,w as d,a4 as u,g as D,Y as E,cr as k,k as c,cs as R,ct as B,j as J}from"./index-f572fea1.js";import{_ as f}from"./SettingSelection.vue_vue_type_script_setup_true_lang-ca4f8b22.js";import{u as G,_ as M}from"./ResetModal.vue_vue_type_script_setup_true_lang-9c828c3f.js";import{u as H}from"./render-33f98e97.js";import{u as I}from"./site-39c51b1e.js";const P={key:0,px:"md:60 lg:120"},q={grid:"","grid-cols-2":"","gap-24":"","lg:grid-cols-2":"","md:grid-cols-2":""},z={"mt-24":"",flex:"","justify-center":"","gap-x-24":""},A={"my-24":"","flex-center":"","gap-x-24":""},Z=h({__name:"MainSetting",setup(F){const r=G(),s=U(),w=H();function V(n){const a=v.find(i=>i.enName===n.enName).value.buttonC,t=k.value?{style:{color:"#ffffff"}}:{};return c("div",{class:"flex items-center gap-x-8"},[c("div",{class:"w-16 h-16 circle border-1 border-fff",style:{backgroundColor:a}}),c("div",t,n.name)])}function p(n){const e=k.value?{style:{color:"#ffffff"}}:{};return c("div",{class:"flex items-center gap-x-8"},[c("div",e,n.name)])}const m=I();function N(){const n={data:m.data,settings:s.settings},e=JSON.stringify(n),a=new Blob([e],{type:"application/json"}),t=URL.createObjectURL(a),i=document.createElement("a");i.download=`COMECOME_Data_${new Date().toLocaleString()}.json`,i.href=t,document.body.appendChild(i),i.click(),URL.revokeObjectURL(t)}function x(){const n=document.createElement("input");n.type="file",n.accept=".json",n.addEventListener("change",async()=>{var a;const e=(a=n.files)==null?void 0:a[0];if(e)try{const t=await e.text(),i=JSON.parse(t);if(!i.data||!i.settings)throw new Error("非法的数据文件");S(i)}catch{window.$message.error("请导入合法的数据文件",{duration:2e3})}}),n.click()}function j(){r.title="重置确认",r.content="是否确认要重置所有设置?",r.resetVisible=!0,r.afterCommit=()=>{R.back()},r.finishCommit=()=>{const e=JSON.parse(JSON.stringify(B));S(e),window.$message.success("重置成功",{duration:2e3})}}function S(n){m.setData(n.data),s.setSettings(n.settings),_(n.settings.theme),C(),m.cateIndex=0,w.refreshSiteGroupList()}function L(){const n={data:m.data,settings:s.settings},e=JSON.stringify(n,null,2),a=encodeURIComponent("[Sync] 用户提交设置更新"),t=encodeURIComponent(["请通过 GitHub Actions 同步以下设置到 preset.json。","","```json",e,"```"].join(`
`)),i=`https://github.com/kyroli/website/issues/new?title=${a}&body=${t}`;window.open(i,"_blank")}return(n,e)=>{const a=J;return b(),y(E,null,[o(s).isSetting?(b(),y("section",P,[g("div",q,[l(f,{modelValue:o(s).settings.theme,"onUpdate:modelValue":e[0]||(e[0]=t=>o(s).settings.theme=t),title:"主题风格",options:o(v),"render-label":V,"label-field":"name","value-field":"enName","on-update-value":t=>("toggleTheme"in n?n.toggleTheme:o(_))(t)},null,8,["modelValue","options","on-update-value"]),l(f,{modelValue:o(s).settings.search,"onUpdate:modelValue":e[1]||(e[1]=t=>o(s).settings.search=t),title:"搜索引擎",options:o(O),"render-label":p,"label-field":"name","value-field":"enName","on-update-value":t=>o(s).setSettings({search:t})},null,8,["modelValue","options","on-update-value"]),l(f,{modelValue:o(s).settings.iconStyle,"onUpdate:modelValue":e[2]||(e[2]=t=>o(s).settings.iconStyle=t),title:"图标风格",options:o(T),"render-label":p,"label-field":"name","value-field":"enName","on-update-value":t=>o(s).setSettings({iconStyle:t})},null,8,["modelValue","options","on-update-value"]),l(f,{modelValue:o(s).settings.siteStyle,"onUpdate:modelValue":e[3]||(e[3]=t=>o(s).settings.siteStyle=t),title:"色彩模式",options:o($),"render-label":p,"label-field":"name","value-field":"enName","on-update-value":t=>{o(s).setSettings({siteStyle:t}),o(C)()}},null,8,["modelValue","options","on-update-value"])]),g("div",z,[l(a,{onClick:j},{default:d(()=>e[5]||(e[5]=[u("重置数据")])),_:1,__:[5]}),l(a,{onClick:x},{default:d(()=>e[6]||(e[6]=[u("导入数据")])),_:1,__:[6]}),l(a,{onClick:N},{default:d(()=>e[7]||(e[7]=[u("导出数据")])),_:1,__:[7]}),l(a,{type:"primary",onClick:L},{default:d(()=>e[8]||(e[8]=[u("同步到 GitHub")])),_:1,__:[8]})]),g("div",A,[l(a,{type:"primary","text-color":"#ffffff",size:"large",onClick:e[4]||(e[4]=t=>n.$router.back())},{default:d(()=>e[9]||(e[9]=[u("返回")])),_:1,__:[9]})])])):D("",!0),l(M)],64)}}});export{Z as _};
